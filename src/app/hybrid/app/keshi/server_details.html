<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <title>服务详情</title>
    <meta charset="utf-8">
    <meta name="keywords" content="服务详情" />
    <meta name="description" content="服务详情" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="服务详情">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="format-detection" content="telephone=no">

    <link rel="stylesheet" type="text/css" href="./css/public.css" />
    <link rel="stylesheet" type="text/css" href="./css/swiper.min.css" />
    <link rel="stylesheet" type="text/css" href="./css/server_details.css" />
</head>
<body>
    <article>
        <div id="top" class="clear boxSha">
            <div class="per-server clear" data-max="1" data-start="1" data-service_id="2" data-next_price="0.01">
                <a href="#">
                    <div class="con-wrap">
                        <h3>卧床清洁 <em><em class="per-time"></em></em>　<em class="color-hong">￥<span class="per-money">0.01</span></em></h3>
                    </div>
                    <!-- <div class="con-wrap">
                        <h3>卧床清洁 <em><em class="per-time"></em></em></h3>
                        <em class="color-hong nextem">￥<span class="per-money">0.01</span>/h ~ ￥0.03/h</em>
                    </div> -->
                </a>
                <div class="btn-sec">
                    <section class="btnc" data-type="remove">
                        <div class="remove borR-50">-</div>
                    </section>
                    <em class="per-num">0</em>
                    <section class="btnc" data-type="add">
                        <div class="add borR-50">+</div>
                    </section>
                </div>
            </div>
            <!-- <p class="nextp">(注：前2小时 ￥20/h，2小时之后 ￥15/h)</p> -->
            <p class="top-p">通过专业清洗头部仪器和手法，全面清洁头发，头皮，轻松按摩缓解头颈,促进血液循环。</p>
        </div>
        <ul id="details-list">
            <li class="per-detai boxSha">
                <h2 class="title">共8个步骤，约1.5小时</h2>
                <div class="swiper-container">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide">
                            <h2 class="loop-title">1.评估（5分钟）</h2>
                            <div class="img-wrap-slide"><img src="imgs/loop.jpg"></div>
                            <p>通过查看皮肤清洁程度，是否有破损等，制定最合适的清洁手法。询问家属详细情况，避免操作禁忌。通过查看皮肤清洁程度，是否有破损等，制定最合适的清洁手法。询问家属详细情况，避免操作禁忌。</p>
                        </div>
                        <div class="swiper-slide">
                            <h2 class="loop-title">1.评估（5分钟）</h2>
                            <div class="img-wrap-slide"><img src="imgs/loop.jpg"></div>
                            <p>通过查看皮肤清洁程度，是否有破损等，制定最合适的清洁手法。询问家属详细情况，避免操作禁忌。</p>
                        </div>
                        <div class="swiper-slide">
                            <h2 class="loop-title">1.评估（5分钟）</h2>
                            <div class="img-wrap-slide"><img src="imgs/loop.jpg"></div>
                            <p>通过查看皮肤清洁程度，是否有破损等，制定最合适的清洁手法。询问家属详细情况，避免操作禁忌。</p>
                        </div>
                        <div class="swiper-slide">
                            <h2 class="loop-title">1.评估（5分钟）</h2>
                            <div class="img-wrap-slide"><img src="imgs/loop.jpg"></div>
                            <p>通过查看皮肤清洁程度，是否有破损等，制定最合适的清洁手法。询问家属详细情况，避免操作禁忌。</p>
                        </div>
                        <div class="swiper-slide">
                            <h2 class="loop-title">1.评估（5分钟）</h2>
                            <div class="img-wrap-slide"><img src="imgs/loop.jpg"></div>
                            <p>通过查看皮肤清洁程度，是否有破损等，制定最合适的清洁手法。询问家属详细情况，避免操作禁忌。</p>
                        </div>
                    </div>
                    <div class="swiper-pagination"></div>
                </div>
            </li>
            <li class="per-detai boxSha">
                <h2 class="title">服务注意事项</h2>
                <ul class="attention-to">
                    <li>服务前，可查看服务人员资格证，核对身份证等</li>
                    <li>服务中，请尽量保持室温高于20度，避免感冒受寒</li>
                    <li>服务中，请自行准备脸盆，毛巾等私人物品，确保健康安全</li>
                </ul>
            </li>
            <li class="per-detai boxSha">
                <h2 class="title">服务须知</h2>
                <ul class="attention-to">
                    <li>服务中，有任何问题，均可拨打我们的客服电话，我们将倾心为您解决（电话号码在微信中可查看）</li>
                    <li>如需要退订服务，请尽量在服务开始前24小时退订。</li>
                </ul>
            </li>
        </ul>
    </article>
    <footer id="sel-true">
        <div class="cart">
            合计 ￥<em class="money">0</em> （共<em class="num">0</em>件）
        </div>
        <div class="button-wrap">
            <a href="#">选好了</a>
        </div>
    </footer>
    <footer id="sel-false">
        还没选好哦
    </footer>
    <div class="statistical" hidden>共计：<em class="all-num">0</em>项  <em class="all-hour">0</em>小时  <span class="c-hong">￥<em class="all-money">0</em></span></div>
    

    <script src="http://s1.anxinsta.com/com/mobile/g.js"></script>
    <script src="http://s1.anxinsta.com/com/mobile/config.js"></script>
    <script>
    G.use(['zepto', 'lib/swiper/swiper.min.js','app/weixin/app/keshi/js/DateSelect.js'], function($, Swiper, DateS){
        // 轮播图
        var swiper = new Swiper('.swiper-container', {
            pagination: '.swiper-pagination',
            autoplay: 3000,
            paginationClickable: true
        });
        var serviceNum = JSON.parse(localStorage.getItem('service')) || {};

        // 给按钮加点击事件
        $('.btnc').on('tap', toAddCart);
        function toAddCart(ev){
            

            if(parseFloat($(this).parents('.per-server').find('.per-num').html()) >= $(this).parents('.per-server').data('max') && $(this).data('type') == 'add'){

                return false;
            }

            // 点击加号，加号变灰色，减号显示
            if($(this).data('type') == 'add'){
                
                showJian($('.btn-sec'));

            }else{
                showJia($('.btn-sec'));
            }
           
            var _this = $(this);
            DateS.addCart(_this, false);

            var service_id = $(this).parents('.per-server').data('service_id');
            serviceNum[service_id] = parseInt($(this).parent().find('.per-num').html());
            if(serviceNum[service_id] == 0) {
                delete serviceNum[service_id];
            }
            var service = JSON.stringify(serviceNum);
            $("#service").val(service);


            localStorage.setItem('service', service);
            console.log(localStorage.getItem('service'));


            return false;
            
        }

        var serviceId = "2"
        var charJson = JSON.parse( localStorage.getItem('service') ) || {};
        var lsNum = charJson[serviceId] ? charJson[serviceId] : 0;
        var preMoney = parseFloat( $('.per-money').html() ).toFixed(2);
        var nextprice = parseFloat($('.per-server').data('next_price'));
        var morenum = parseFloat( lsNum ) - parseFloat($('.per-server').data('start'));
        var am = 0;

        if(lsNum > parseFloat($('.per-server').data('start'))){
            am += parseFloat(DateS.accMul(nextprice, morenum).toFixed(2));
            am += parseFloat( DateS.accMul(preMoney, parseFloat($('.per-server').data('start'))).toFixed(2) )
        }else{
            am = parseFloat( DateS.accMul(preMoney, lsNum).toFixed(2) )
        }

        $('.per-num').html(lsNum);
        $('.money').html( am );
        $('.num').html( lsNum );

        $('.all-num').html(lsNum);
        $('.all-money').html(am); 
        if(lsNum != 0){
            $('.remove').css({color : '#ff4500'});
            showJian($('.btn-sec'));
        }else{
            showJia($('.btn-sec'));
        }

        if(lsNum){
            $('#sel-true').show();
            $('#sel-false').hide();
        }



        function showJian(elem){
            $(elem).find('.remove').css({color : '#ff4500', visibility: 'visible'});
            $(elem).find('.per-num').css({visibility: 'visible'});
            // 加变灰
            $(elem).find('.add').css({color : '#999999'});
        }

        function showJia(elem){
            $(elem).find('.remove').css({color : '#ff4500', visibility: 'hidden'});
            $(elem).find('.per-num').css({visibility: 'hidden'});
            // 加变灰
            $(elem).find('.add').css({color : '#ff4500'});
        }

        // 计算轮播图的最小高度
        var minH = 11 / 20 * $(window).width();
        $('.swiper-slide').css({minHeight : minH});

    });
    </script>
</body>
</html>